routers:
  - server: "restapi-user"                                                    # å¯¹åº”æœåŠ¡å
    prefix: "/api/v1/user"                                                    # æ˜ å°„çš„ URL å‰ç¼€
  - server: "restapi-map"
    prefix: "/api/v1/map"

servers:
  - name: "restapi-user"                                                      # æœåŠ¡å”¯ä¸€æ ‡è¯†
    description: "ç”¨æˆ·æœåŠ¡"                                                    # æœåŠ¡æè¿°
    auth:
      mode: "bearer"                                                          # è®¤è¯æ–¹å¼ï¼šbearer / apikey / none
      header: "Authorization"                                                 # ä»å“ªä¸ª Header æå–è®¤è¯å­—æ®µ
      argKey: "accessToken"                                                   # å‚æ•°ä¸­è®¤è¯å­—æ®µçš„é€»è¾‘åï¼ˆå¦‚ï¼šparams ä¸­å­—æ®µåï¼‰
    allowedTools:
      - "user_register"                                                       # å½“å‰æœåŠ¡å…è®¸æš´éœ²çš„å·¥å…·
      - "user_email"
    allowedOrigins:
      - "https://security.example.com"                                        # è·¨åŸŸå…è®¸çš„ originï¼ˆç”¨äº CORSï¼‰

  - name: "restapi-map"
    description: "åœ°å›¾æœåŠ¡"
    auth:
      mode: "apikey"
      header: "X-API-Key"
      argKey: "apiKey"
    allowedTools:
      - "user_location_get"
      - "user_location_bind"

tools:
  - name: "user_register"                                                     # å·¥å…·åç§°
    description: "æ³¨å†Œä¸€ä¸ªç”¨æˆ·"                                                 # å·¥å…·æè¿°
    method: "POST"                                                            # è¯·æ±‚æ–¹æ³•
    endpoint: "https://api.example.com/users"                                 # è¯·æ±‚åœ°å€ï¼ˆæ”¯æŒæ¨¡æ¿ï¼‰
    headers:
      Content-Type:      "application/json"                                   # å›ºå®šè¯·æ±‚å¤´
      Authorization:     "{{args.accessToken}}"                               # ä» LLM å‚æ•°æ³¨å…¥
      X-Trace-Id:        "{{request.headers.X-Trace-Id}}"                     # åŸå§‹ header æ˜ å°„æ³¨å…¥
    args:
      - name: "username"
        position: "body"
        required: true
        type: "string"
        description: "ç”¨æˆ·å"
        default: ""
      - name: "email"
        position: "body"
        required: true
        type: "string"
        description: "é‚®ç®±"
        default: ""
      - name: "accessToken"
        position: "header"
        required: true
        type: "string"
        description: "èº«ä»½è®¤è¯ token"
        default: ""
    requestBody: |-
      {
        "username": "{{args.username}}",
        "email": "{{args.email}}",
        "ua": "{{request.headers.User-Agent}}"
      }
    responseBody: |-
      æ³¨å†ŒæˆåŠŸ ğŸ‰
      - ç”¨æˆ·åï¼š{{response.data.username}}
      - é‚®ç®±ï¼š{{response.data.email}}

  - name: "user_location_get"
    description: "è·å–ç”¨æˆ·æœ€è¿‘ä¸€æ¬¡ä½ç½®"
    method: "GET"
    endpoint: "https://api.map.com/location/{{args.userId}}/last?region={{args.region}}"
    headers:
      X-API-Key:          "{{args.apiKey}}"                                   # LLM æä¾›çš„å¯†é’¥
      X-Forwarded-For:    "{{request.headers.X-Forwarded-For}}"               # ä» header ç›´æ¥é€ä¼ 
    args:
      - name: "userId"
        position: "path"
        required: true
        type: "string"
        description: "ç”¨æˆ· ID"
        default: ""
      - name: "region"
        position: "query"
        required: false
        type: "string"
        description: "åŒºåŸŸä»£ç "
        default: ""
      - name: "apiKey"
        position: "header"
        required: true
        type: "string"
        description: "è®¤è¯ç”¨çš„ API Key"
        default: ""
    responseBody: |-
      ğŸ“ æœ€è¿‘ä½ç½®ï¼š
      - çº¬åº¦ï¼š{{response.data.lat}}
      - ç»åº¦ï¼š{{response.data.lng}}
      - æ—¶é—´ï¼š{{response.data.timestamp}}

  - name: "user_location_bind"
    description: "ç»‘å®šç”¨æˆ·åˆ°æŒ‡å®šä½ç½®"
    method: "POST"
    endpoint: "https://api.map.com/location/bind"
    headers:
      Content-Type:     "application/json"
      X-API-Key:        "{{args.apiKey}}"
      X-Client-IP:      "{{request.headers.X-Client-IP}}"
    args:
      - name: "userId"
        position: "body"
        required: true
        type: "string"
        description: "ç”¨æˆ· ID"
        default: ""
      - name: "lat"
        position: "body"
        required: true
        type: "float"
        description: "çº¬åº¦"
        default: "0"
      - name: "lng"
        position: "body"
        required: true
        type: "float"
        description: "ç»åº¦"
        default: "0"
      - name: "apiKey"
        position: "header"
        required: true
        type: "string"
        description: "è®¤è¯ç”¨çš„ API Key"
        default: ""
    requestBody: |-
      {
        "userId": "{{args.userId}}",
        "lat": {{args.lat}},
        "lng": {{args.lng}},
        "ip": "{{request.headers.X-Client-IP}}"
      }
    responseBody: |-
      âœ… å·²ä¸ºç”¨æˆ· {{args.userId}} ç»‘å®šåæ ‡ï¼š
      - çº¬åº¦ï¼š{{response.data.lat}}
      - ç»åº¦ï¼š{{response.data.lng}}